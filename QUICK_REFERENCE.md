# ä¿ƒé”€æ¨¡å‹å¿«é€Ÿå‚è€ƒå¡ (Quick Reference Card)

## ğŸ“Š 7ä¸ªæ ¸å¿ƒæ•°æ®è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. promotion_activity (ä¿ƒé”€æ´»åŠ¨ä¸»è¡¨)                        â”‚
â”‚     â””â”€ å­˜å‚¨ä¿ƒé”€æ´»åŠ¨åŸºæœ¬ä¿¡æ¯ã€æ—¶é—´ã€çŠ¶æ€ã€é¢„ç®—ç­‰             â”‚
â”‚                                                              â”‚
â”‚  2. promotion_rule (ä¿ƒé”€è§„åˆ™è¡¨)                              â”‚
â”‚     â””â”€ å®šä¹‰ä¿ƒé”€è®¡ç®—è§„åˆ™ã€æ¡ä»¶ã€ä¼˜æƒ æ–¹å¼                     â”‚
â”‚                                                              â”‚
â”‚  3. promotion_product (ä¿ƒé”€å•†å“å…³è”è¡¨)                       â”‚
â”‚     â””â”€ ç®¡ç†å‚ä¸ä¿ƒé”€çš„å•†å“èŒƒå›´å’Œåº“å­˜                         â”‚
â”‚                                                              â”‚
â”‚  4. promotion_coupon (ä¼˜æƒ åˆ¸è¡¨)                              â”‚
â”‚     â””â”€ ä¼˜æƒ åˆ¸å®šä¹‰ã€å‘è¡Œé‡ã€ä½¿ç”¨æ¡ä»¶                         â”‚
â”‚                                                              â”‚
â”‚  5. promotion_user_coupon (ç”¨æˆ·ä¼˜æƒ åˆ¸è¡¨)                     â”‚
â”‚     â””â”€ ç”¨æˆ·é¢†å–çš„ä¼˜æƒ åˆ¸åŠä½¿ç”¨çŠ¶æ€                           â”‚
â”‚                                                              â”‚
â”‚  6. promotion_usage_record (ä¿ƒé”€ä½¿ç”¨è®°å½•è¡¨)                  â”‚
â”‚     â””â”€ å®Œæ•´çš„ä¿ƒé”€ä½¿ç”¨å†å²å’Œé€€æ¬¾è®°å½•                         â”‚
â”‚                                                              â”‚
â”‚  7. promotion_statistics (ä¿ƒé”€ç»Ÿè®¡è¡¨)                        â”‚
â”‚     â””â”€ æ¯æ—¥ä¿ƒé”€æ•ˆæœæ•°æ®ç»Ÿè®¡                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ 6ç§ä¿ƒé”€ç±»å‹

| ç±»å‹ | ä»£ç  | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|-----|------|------|---------|
| æŠ˜æ‰£ä¿ƒé”€ | DISCOUNT | ç™¾åˆ†æ¯”æˆ–å›ºå®šé‡‘é¢æŠ˜æ‰£ | å…¨åœº8æŠ˜ã€å•å“ç‰¹ä»· |
| æ»¡å‡ä¿ƒé”€ | FULL_REDUCTION | æ»¡Xå…ƒå‡Yå…ƒ | æ»¡100å‡20ã€æ»¡200å‡50 |
| æ»¡èµ ä¿ƒé”€ | FULL_GIFT | ä¹°Xä»¶é€Yä»¶ | ä¹°2é€1ã€æ»¡é¢é€èµ å“ |
| ä¼˜æƒ åˆ¸ | COUPON | å„ç±»ä¼˜æƒ åˆ¸ | æ–°ç”¨æˆ·åˆ¸ã€æ»¡å‡åˆ¸ã€è¿è´¹åˆ¸ |
| é™æ—¶æŠ¢è´­ | FLASH_SALE | é™æ—¶é™é‡ç‰¹ä»· | ç§’æ€ã€æ¯æ—¥ç‰¹ä»· |
| ç»„åˆå¥—é¤ | BUNDLE | å•†å“ç»„åˆä¼˜æƒ  | å¥—é¤ä»·ã€ä¹°A+Bä¼˜æƒ  |

## ğŸ”„ ä¿ƒé”€æ´»åŠ¨çŠ¶æ€æµè½¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ è‰ç¨¿ â”‚ -> â”‚ å¾…å¼€å§‹  â”‚ -> â”‚ è¿›è¡Œä¸­  â”‚ -> â”‚ å·²ç»“æŸâ”‚    â”‚ å·²åœç”¨â”‚
â”‚  0   â”‚    â”‚   1     â”‚    â”‚   2     â”‚    â”‚  3   â”‚    â”‚  4   â”‚
â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜
              ^                                            |
              |____________________________________________|
                          (æ‰‹åŠ¨åœç”¨)
```

## ğŸ’¡ æ ¸å¿ƒå­—æ®µè¯´æ˜

### promotion_activity (ä¿ƒé”€æ´»åŠ¨)
- `activity_no`: æ´»åŠ¨ç¼–å·ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
- `activity_type`: ä¿ƒé”€ç±»å‹ï¼ˆè§ä¸Šè¡¨ï¼‰
- `priority`: ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå¤§è¶Šä¼˜å…ˆï¼‰
- `can_stack`: æ˜¯å¦å¯å åŠ ï¼ˆ0/1ï¼‰
- `start_time/end_time`: æ´»åŠ¨æ—¶é—´
- `total_budget`: æ€»é¢„ç®—
- `per_user_limit_count`: æ¯ç”¨æˆ·é™åˆ¶æ¬¡æ•°

### promotion_rule (ä¿ƒé”€è§„åˆ™)
- `rule_type`: è§„åˆ™ç±»å‹ï¼ˆTHRESHOLD/DISCOUNT/GIFT/REDUCTIONï¼‰
- `condition_type`: æ¡ä»¶ç±»å‹ï¼ˆAMOUNT/QUANTITY/NONEï¼‰
- `discount_type`: ä¼˜æƒ ç±»å‹ï¼ˆPERCENTAGE/FIXED_AMOUNT/FIXED_PRICE/FREE_SHIPPINGï¼‰
- `discount_value`: ä¼˜æƒ å€¼
- `step_rule`: æ˜¯å¦é˜¶æ¢¯è§„åˆ™ï¼ˆ0/1ï¼‰

### promotion_product (ä¿ƒé”€å•†å“)
- `product_scope_type`: èŒƒå›´ç±»å‹ï¼ˆALL/CATEGORY/BRAND/SKU/SPU/EXCLUDEï¼‰
- `stock_quantity`: ä¿ƒé”€åº“å­˜ï¼ˆç§’æ€ç”¨ï¼‰
- `sold_quantity`: å·²å”®æ•°é‡
- `limit_per_user`: æ¯ç”¨æˆ·é™è´­

### promotion_coupon (ä¼˜æƒ åˆ¸)
- `coupon_code`: ä¼˜æƒ åˆ¸ä»£ç ï¼ˆå”¯ä¸€ï¼‰
- `coupon_type`: åˆ¸ç±»å‹ï¼ˆUNIVERSAL/PRODUCT/SHIPPING/CASHï¼‰
- `min_order_amount`: æœ€ä½è®¢å•é‡‘é¢
- `per_user_limit`: æ¯ç”¨æˆ·é¢†å–é™åˆ¶
- `valid_days`: æœ‰æ•ˆå¤©æ•°

## ğŸ“ å¸¸ç”¨SQLæŸ¥è¯¢æ¨¡æ¿

### 1. æŸ¥è¯¢å½“å‰æœ‰æ•ˆä¿ƒé”€
```sql
SELECT * FROM promotion_activity 
WHERE status = 2 
  AND NOW() BETWEEN start_time AND end_time;
```

### 2. æŸ¥è¯¢å•†å“ä¿ƒé”€ä»·
```sql
SELECT p.promotion_price, a.activity_name
FROM promotion_product p
JOIN promotion_activity a ON p.activity_id = a.id
WHERE p.company_sku = ? AND a.status = 2;
```

### 3. æŸ¥è¯¢ç”¨æˆ·å¯ç”¨ä¼˜æƒ åˆ¸
```sql
SELECT uc.*, c.coupon_name, c.discount_value
FROM promotion_user_coupon uc
JOIN promotion_coupon c ON uc.coupon_id = c.id
WHERE uc.user_id = ? AND uc.use_status = 0
  AND NOW() BETWEEN uc.valid_start_time AND uc.valid_end_time;
```

### 4. è®°å½•ä¿ƒé”€ä½¿ç”¨
```sql
INSERT INTO promotion_usage_record 
(activity_id, user_id, order_no, original_amount, 
 discount_amount, final_amount, use_time)
VALUES (?, ?, ?, ?, ?, ?, NOW());
```

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

```bash
# 1. æ‰§è¡ŒSQLæ–‡ä»¶
mysql -u username -p database < promotion_model.sql

# 2. éªŒè¯å®‰è£…
mysql -u username -p database -e "SHOW TABLES LIKE 'promotion_%';"

# 3. æŸ¥çœ‹ç¤ºä¾‹æ•°æ®
mysql -u username -p database -e "SELECT * FROM promotion_activity;"
```

## ğŸ” å®‰å…¨æ£€æŸ¥æ¸…å•

- [ ] è®¾ç½®ä¿ƒé”€é¢„ç®—ä¸Šé™
- [ ] é…ç½®ç”¨æˆ·ä½¿ç”¨æ¬¡æ•°é™åˆ¶
- [ ] å®ç°å¹¶å‘åº“å­˜æ§åˆ¶ï¼ˆä¹è§‚é”ï¼‰
- [ ] éªŒè¯ä¼˜æƒ é‡‘é¢ä¸è¶…è¿‡åŸä»·
- [ ] é˜²æ­¢ä¼˜æƒ åˆ¸ä»£ç æš´åŠ›ç ´è§£
- [ ] é™åˆ¶APIè®¿é—®é¢‘ç‡
- [ ] è®°å½•å®Œæ•´çš„æ“ä½œæ—¥å¿—

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹

1. **ç´¢å¼•ä¼˜åŒ–**
   - status + time å¤åˆç´¢å¼•
   - SKUå­—æ®µç´¢å¼•
   - user_idç´¢å¼•

2. **ç¼“å­˜ç­–ç•¥**
   - ç¼“å­˜å½“å‰æœ‰æ•ˆä¿ƒé”€æ´»åŠ¨
   - ç¼“å­˜å•†å“ä¿ƒé”€ä»·æ ¼
   - ç¼“å­˜ç”¨æˆ·ä¼˜æƒ åˆ¸åˆ—è¡¨

3. **è¯»å†™åˆ†ç¦»**
   - ä¿ƒé”€è®¡ç®—ç”¨ä¸»åº“
   - ç»Ÿè®¡æŸ¥è¯¢ç”¨ä»åº“

4. **å¼‚æ­¥å¤„ç†**
   - ç»Ÿè®¡æ•°æ®å¼‚æ­¥è®¡ç®—
   - æ‰¹é‡å‘åˆ¸ä½¿ç”¨é˜Ÿåˆ—

## ğŸ§ª æµ‹è¯•æ£€æŸ¥é¡¹

| æµ‹è¯•é¡¹ | æµ‹è¯•å†…å®¹ | é¢„æœŸç»“æœ |
|-------|---------|---------|
| æŠ˜æ‰£è®¡ç®— | 8æŠ˜ï¼ŒåŸä»·100å…ƒ | ä¼˜æƒ 20å…ƒï¼Œå®ä»˜80å…ƒ |
| æ»¡å‡è®¡ç®— | æ»¡100å‡20ï¼Œè´­ä¹°120å…ƒ | ä¼˜æƒ 20å…ƒï¼Œå®ä»˜100å…ƒ |
| æ»¡å‡æœªè¾¾æ ‡ | æ»¡100å‡20ï¼Œè´­ä¹°99å…ƒ | æ— ä¼˜æƒ ï¼Œå®ä»˜99å…ƒ |
| ä¼˜æƒ åˆ¸é™åˆ¶ | æ»¡200ç”¨50å…ƒåˆ¸ï¼Œè´­ä¹°150å…ƒ | ä¸å¯ä½¿ç”¨ |
| ç§’æ€åº“å­˜ | åº“å­˜10ä»¶ï¼Œ11äººè´­ä¹° | å‰10äººæˆåŠŸï¼Œç¬¬11äººå¤±è´¥ |
| ä¿ƒé”€å åŠ  | 8æŠ˜+æ»¡å‡ | æŒ‰ä¼˜å…ˆçº§è®¡ç®— |
| ä½¿ç”¨é™åˆ¶ | é™è´­2ä»¶ï¼Œè´­ä¹°3ä»¶ | åªèƒ½è´­ä¹°2ä»¶ |

## ğŸ“š æ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | å†…å®¹ | ç”¨é€” |
|-----|------|------|
| promotion_model.sql | SQLè„šæœ¬ | æ•°æ®åº“éƒ¨ç½² |
| PROMOTION_MODEL_DESIGN.md | è®¾è®¡æ–‡æ¡£(ä¸­æ–‡) | ç†è§£è®¾è®¡ |
| PROMOTION_MODEL_EN.md | è®¾è®¡æ–‡æ¡£(è‹±æ–‡) | English Reference |
| IMPLEMENTATION_GUIDE.md | å®æ–½æŒ‡å— | å®é™…å¼€å‘ |
| promotion_model_diagram.txt | ERå›¾ | æ•°æ®å…³ç³» |
| QUICK_REFERENCE.md | å¿«é€Ÿå‚è€ƒ | é€ŸæŸ¥æ‰‹å†Œ |

## ğŸ’¬ ç¤ºä¾‹åœºæ™¯é€ŸæŸ¥

### åˆ›å»º8æŠ˜ä¿ƒé”€
```sql
INSERT INTO promotion_activity (...) VALUES ('PROMO001', 'å…¨åœº8æŠ˜', 'DISCOUNT', ...);
INSERT INTO promotion_rule (...) VALUES (LAST_INSERT_ID(), 'DISCOUNT', 'PERCENTAGE', 80.00);
```

### åˆ›å»ºæ»¡100å‡20
```sql
INSERT INTO promotion_activity (...) VALUES ('PROMO002', 'æ»¡100å‡20', 'FULL_REDUCTION', ...);
INSERT INTO promotion_rule (...) VALUES (LAST_INSERT_ID(), 'REDUCTION', 'AMOUNT', 100, 'FIXED_AMOUNT', 20);
```

### åˆ›å»ºç§’æ€
```sql
INSERT INTO promotion_activity (...) VALUES ('FLASH001', 'ç§’æ€', 'FLASH_SALE', ...);
INSERT INTO promotion_product (...) VALUES (LAST_INSERT_ID(), 'SKU', ..., 99.00, 100, 2);
```

### åˆ›å»ºä¼˜æƒ åˆ¸
```sql
INSERT INTO promotion_activity (...) VALUES ('COUPON001', 'æ–°ç”¨æˆ·åˆ¸', 'COUPON', ...);
INSERT INTO promotion_coupon (...) VALUES (LAST_INSERT_ID(), 'NEW50', 'FIXED_AMOUNT', 50, 100);
```

## ğŸ”§ ç»´æŠ¤å»ºè®®

### æ—¥å¸¸ç»´æŠ¤
- æ¯æ—¥æ£€æŸ¥æ´»åŠ¨çŠ¶æ€
- ç›‘æ§ä¿ƒé”€ä½¿ç”¨é‡
- å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
- å¤‡ä»½ä¿ƒé”€é…ç½®

### å®šæœŸä»»åŠ¡
- æ¯å¤©00:00 ç»Ÿè®¡å‰ä¸€å¤©æ•°æ®
- æ¯å¤©01:00 æ›´æ–°ä¿ƒé”€çŠ¶æ€
- æ¯å‘¨æ¸…ç†90å¤©å‰çš„ä½¿ç”¨è®°å½•
- æ¯æœˆç”Ÿæˆä¿ƒé”€æ•ˆæœæŠ¥è¡¨

### å‘Šè­¦è®¾ç½®
- é¢„ç®—ä½¿ç”¨è¶…è¿‡80%
- åº“å­˜ä¸è¶³ï¼ˆç§’æ€ï¼‰
- ä¿ƒé”€è®¡ç®—å¼‚å¸¸
- APIå“åº”æ—¶é—´è¶…è¿‡1ç§’

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ
1. æŸ¥çœ‹ IMPLEMENTATION_GUIDE.md å¸¸è§é—®é¢˜éƒ¨åˆ†
2. æŸ¥çœ‹ PROMOTION_MODEL_DESIGN.md è¯¦ç»†è®¾è®¡
3. æ£€æŸ¥æ•°æ®åº“æ—¥å¿—å’Œåº”ç”¨æ—¥å¿—
4. æäº¤issueåˆ°GitHubä»“åº“

---

**ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°æ—¥æœŸ**: 2026-01-12  
**ç»´æŠ¤**: buyi_cloud team
